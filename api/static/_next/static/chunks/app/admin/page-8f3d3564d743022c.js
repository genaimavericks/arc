(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{7394:(e,s,t)=>{Promise.resolve().then(t.bind(t,8782))},8782:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ep});var a=t(5155),r=t(425),i=t(4110),n=t(2115),o=t(8173),l=t.n(o),d=t(3638),c=t(6062),m=t(2823),u=t(6745),h=t(2640),x=t(8236),p=t(7364),g=t(1069),f=t(6046),b=t(7358);async function j(){try{let e=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t={Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"},a=await fetch("".concat(e,"/admin/stats"),{headers:t}),r=await fetch("".concat(e,"/admin/users"),{headers:t}),i=await fetch("".concat(e,"/admin/settings"),{headers:t});if(!a.ok||!r.ok||!i.ok)throw console.error("Failed to fetch admin data:",{stats:a.status,users:r.status,settings:i.status}),Error("Failed to fetch admin data");let n=await a.json(),o=await r.json(),l=await i.json(),d=[];try{let s=new Date().getTime(),a=await fetch("".concat(e,"/admin/activity?limit=50&_t=").concat(s),{headers:t});if(a.ok)d=await a.json(),console.log("Fetched activity data:",d),d=d.map(e=>({...e,username:e.username||"anonymous"}));else throw console.warn("Activity logs fetch returned non-OK status:",a.status),Error("Failed to fetch activity logs: ".concat(a.statusText))}catch(e){console.error("Error fetching activity logs:",e),d=[{id:1,action:"User login",username:"admin",timestamp:new Date().toISOString(),details:"Activity log system initialized with fallback data",page_url:null}]}return{stats:n,users:o,activity:d,systemSettings:l}}catch(e){return console.error("Error fetching admin data:",e),{stats:{total_users:42,active_users:38,researchers:15,regular_users:26,system_uptime:"3 days, 7 hours",database_size:"42.5 MB"},users:[{id:1,username:"admin",email:"admin@example.com",role:"admin",is_active:!0,created_at:new Date().toISOString()},{id:2,username:"researcher",email:"researcher@example.com",role:"researcher",is_active:!0,created_at:new Date(Date.now()-864e5).toISOString()},{id:3,username:"user",email:"user@example.com",role:"user",is_active:!0,created_at:new Date(Date.now()-1728e5).toISOString()}],activity:[{id:1,action:"Login",username:"admin",timestamp:new Date().toISOString(),details:"User admin logged in successfully",page_url:null},{id:2,action:"Page visit",username:"researcher",timestamp:new Date(Date.now()-9e5).toISOString(),details:"Visited dashboard page",page_url:"/datapuur/dashboard"},{id:3,action:"Failed login attempt",username:"unknown",timestamp:new Date(Date.now()-18e5).toISOString(),details:"Invalid credentials",page_url:null}],systemSettings:{maintenance_mode:!1,debug_mode:!0,api_rate_limiting:!0,last_backup:new Date(Date.now()-864e5).toISOString()}}}}async function v(e){try{let s=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",t=localStorage.getItem("token"),a=await fetch("".concat(s,"/admin/users"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.detail||"Failed to create user")}let r=await a.json();return r.created_at||(r.created_at=new Date().toISOString()),r}catch(e){throw console.error("Error creating user:",e),e}}async function y(e,s){try{let t=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",a=localStorage.getItem("token"),r=await fetch("".concat(t,"/admin/users/").concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){let e=await r.json();throw Error(e.detail||"Failed to update user")}return await r.json()}catch(e){throw console.error("Error updating user:",e),e}}async function N(e){try{let s=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",t=localStorage.getItem("token"),a=await fetch("".concat(s,"/admin/users/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.detail||"Failed to delete user")}return}catch(e){throw console.error("Error deleting user:",e),e}}async function w(e,s){try{let t=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",a=localStorage.getItem("token"),r=await fetch("".concat(t,"/admin/settings"),{method:"PUT",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({[e]:s})});if(!r.ok){let e=await r.json();throw Error(e.detail||"Failed to update system setting")}return await r.json()}catch(e){throw console.error("Error updating system setting:",e),e}}async function _(){try{let e=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t=await fetch("".concat(e,"/admin/backup"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to run backup")}return await t.json()}catch(e){throw console.error("Error running backup:",e),e}}async function A(){try{let e=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t=await fetch("".concat(e,"/admin/export-data"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to export data")}return await t.json()}catch(e){throw console.error("Error exporting data:",e),e}}async function k(e){try{let s=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",t=localStorage.getItem("token"),a=await fetch("".concat(s,"/admin/activity/clear").concat(e?"?days=".concat(e):""),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.detail||"Failed to clear activity logs")}return}catch(e){throw console.error("Error clearing activity logs:",e),e}}async function C(){try{let e=b.env.NEXT_PUBLIC_API_URL?b.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t=await fetch("".concat(e,"/admin/cleanup-data"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to cleanup data")}return await t.json()}catch(e){throw console.error("Error cleaning up data:",e),e}}var S=t(5472);let E=(0,t(9827).v)(e=>({loading:!1,setLoading:s=>e({loading:s}),error:null,setError:s=>e({error:s}),notification:null,setNotification:s=>e({notification:s}),stats:null,setStats:s=>e({stats:s}),users:[],setUsers:s=>e({users:s}),activity:[],setActivity:s=>e({activity:s}),systemSettings:null,setSystemSettings:s=>e({systemSettings:s}),roles:[{id:1,name:"admin",description:"Administrator with full access",permissions:["data:read","data:write","user:read","user:write","role:read","role:write"],is_system_role:!0},{id:2,name:"user",description:"Regular user with limited access",permissions:["data:read"],is_system_role:!0},{id:3,name:"researcher",description:"Researcher with data access",permissions:["data:read","data:write","schema:read","ingestion:read"],is_system_role:!0}],setRoles:s=>e({roles:s}),addRole:s=>e(e=>({roles:[...e.roles,s]})),updateRole:s=>e(e=>({roles:e.roles.map(e=>e.id===s.id?s:e)})),deleteRole:s=>e(e=>({roles:e.roles.filter(e=>e.id!==s)})),addRoleIfNotExists:(s,t)=>e(e=>{if(!e.roles.find(e=>e.name===s)){let a=e.roles.length>0?Math.max(...e.roles.map(e=>e.id||0)):0;return{roles:[...e.roles,{id:a+1,name:s,description:t||"",permissions:[],is_system_role:!1}]}}return e}),availablePermissions:["data:read","data:write","user:read","user:write","role:read","role:write","schema:read","schema:write","ingestion:read","ingestion:write"],setAvailablePermissions:s=>e({availablePermissions:s}),isProcessing:!1,setIsProcessing:s=>e({isProcessing:s}),datasets:[],setDatasets:s=>e({datasets:s}),datasetDetails:null,setDatasetDetails:s=>e({datasetDetails:s}),schemas:[],setSchemas:s=>e({schemas:s}),schemaDetails:null,setSchemaDetails:s=>e({schemaDetails:s}),ingestions:[],setIngestions:s=>e({ingestions:s}),ingestionDetails:null,setIngestionDetails:s=>e({ingestionDetails:s}),ingestionLogs:[],setIngestionLogs:s=>e({ingestionLogs:s}),notifications:[],addNotification:s=>e(e=>({notifications:[...e.notifications,{...s,id:Date.now().toString()}]})),removeNotification:s=>e(e=>({notifications:e.notifications.filter(e=>e.id!==s)}))}));var I=t(1476);function P(){let{stats:e,activity:s}=E(),t={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e?(0,a.jsxs)(d.P.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"System Overview"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(d.P.div,{variants:t,whileHover:{scale:1.02},className:"bg-card/80 backdrop-blur-sm p-6 rounded-lg border border-border shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-foreground mb-4 flex items-center",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 mr-2 text-primary"}),"User Statistics"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Users:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.total_users)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Active Users:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.active_users)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Researchers:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.researchers)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Regular Users:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.regular_users)||0})]})]})]}),(0,a.jsxs)(d.P.div,{variants:t,whileHover:{scale:1.02},className:"bg-card/80 backdrop-blur-sm p-6 rounded-lg border border-border shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-foreground mb-4 flex items-center",children:[(0,a.jsx)(I.A,{className:"h-5 w-5 mr-2 text-secondary"}),"System Status"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Uptime:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.system_uptime)||"N/A"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Database Size:"}),(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==e?void 0:e.database_size)||"N/A"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)("span",{className:"text-primary font-medium",children:"Operational"})]})]})]}),(0,a.jsxs)(d.P.div,{variants:t,whileHover:{scale:1.02},className:"bg-card/80 backdrop-blur-sm p-6 rounded-lg border border-border shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-foreground mb-4 flex items-center",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 mr-2 text-primary"}),"Recent Activity"]}),s&&s.length>0?(0,a.jsx)("div",{className:"space-y-3",children:s.slice(0,3).map((e,s)=>(0,a.jsxs)(d.P.div,{variants:e,className:"text-sm p-2 rounded-md bg-background/50 hover:bg-background transition-colors",children:[(0,a.jsx)("div",{className:"text-foreground font-medium",children:e.action}),(0,a.jsxs)("div",{className:"text-muted-foreground text-xs",children:[new Date(e.timestamp).toLocaleString()," - ",e.username]})]},e.id||s))}):(0,a.jsx)("p",{className:"text-muted-foreground",children:"No recent activity"})]})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"System Overview"}),(0,a.jsx)("div",{className:"bg-card/80 backdrop-blur-sm p-6 rounded-lg border border-border",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading system statistics..."})})]})}var L=t(7517),U=t(4085),R=t(1773),T=t(7837),F=t(2336),B=t(5785),D=t(2581),O=t(745);function z(e){let{open:s,onOpenChange:t,user:r}=e,{users:i,setUsers:o,isProcessing:l,setIsProcessing:d,setNotification:c,addRoleIfNotExists:m}=E(),[u,h]=(0,n.useState)({username:r.username,email:r.email,role:r.role,is_active:r.is_active}),{roles:x}=E();(0,n.useEffect)(()=>{r.role&&m(r.role)},[r.role,m]);let p=async()=>{d(!0);try{m(u.role);let e=await y(r.id,u);o(i.map(s=>s.id===e.id?e:s)),c({type:"success",message:"User ".concat(e.username," updated successfully")}),t(!1),setTimeout(()=>c(null),3e3)}catch(e){console.error("Error updating user:",e),c({type:"error",message:e.message||"Failed to update user"}),setTimeout(()=>c(null),3e3)}finally{d(!1)}};return(0,a.jsx)(T.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(T.Cf,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(T.c7,{children:(0,a.jsx)(T.L3,{children:"Edit User"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"username",children:"Username"}),(0,a.jsx)(F.p,{id:"username",value:u.username,onChange:e=>h({...u,username:e.target.value}),className:"bg-background border-input text-foreground",disabled:"admin"===r.username})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(F.p,{id:"email",value:u.email,onChange:e=>h({...u,email:e.target.value}),className:"bg-background border-input text-foreground"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"role",children:"Role"}),(0,a.jsxs)(O.l6,{value:u.role,onValueChange:e=>h({...u,role:e}),disabled:"admin"===r.username,children:[(0,a.jsx)(O.bq,{className:"bg-background border-input text-foreground",children:(0,a.jsx)(O.yv,{placeholder:"Select a role"})}),(0,a.jsx)(O.gC,{className:"bg-popover border border-border text-popover-foreground",children:x.map(e=>(0,a.jsx)(O.eb,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.d,{id:"is_active",checked:u.is_active,onCheckedChange:e=>h({...u,is_active:e}),disabled:"admin"===r.username}),(0,a.jsx)(B.J,{htmlFor:"is_active",children:"Active"})]})]}),(0,a.jsxs)(T.Es,{children:[(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:p,disabled:l,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Saving..."]}):"Save Changes"})]})]})})}function J(e){let{open:s,onOpenChange:t,user:r}=e,{users:i,setUsers:n,isProcessing:o,setIsProcessing:l,setNotification:d}=E(),c=async()=>{l(!0);try{await N(r.id),n(i.filter(e=>e.id!==r.id)),d({type:"success",message:"User ".concat(r.username," deleted successfully")}),t(!1),setTimeout(()=>d(null),3e3)}catch(e){console.error("Error deleting user:",e),d({type:"error",message:e.message||"Failed to delete user"}),setTimeout(()=>d(null),3e3)}finally{l(!1)}};return(0,a.jsx)(T.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(T.Cf,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(T.c7,{children:(0,a.jsx)(T.L3,{children:"Delete User"})}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("p",{children:["Are you sure you want to delete user ",(0,a.jsx)("strong",{children:r.username}),"?"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone."})]}),(0,a.jsxs)(T.Es,{children:[(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(U.Button,{className:"bg-destructive hover:bg-destructive/80 text-white",onClick:c,disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Deleting..."]}):"Delete User"})]})]})})}function X(e){let{open:s,onOpenChange:t}=e,{users:r,setUsers:i,isProcessing:o,setIsProcessing:l,setNotification:d,roles:c,addRoleIfNotExists:m}=E(),[u,h]=(0,n.useState)({username:"",email:"",password:"",role:"user",is_active:!0}),x=async()=>{if(!u.username||!u.email||!u.password){d({type:"error",message:"Please fill in all required fields"});return}m(u.role),l(!0);try{let e=await v(u);e.created_at||(e.created_at=new Date().toISOString()),i([...r,e]),d({type:"success",message:"User ".concat(e.username," created successfully")}),t(!1),h({username:"",email:"",password:"",role:"user",is_active:!0}),setTimeout(()=>d(null),3e3)}catch(e){console.error("Error adding user:",e),d({type:"error",message:e.message||"Failed to create user"}),setTimeout(()=>d(null),3e3)}finally{l(!1)}};return(0,a.jsx)(T.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(T.Cf,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(T.c7,{children:(0,a.jsx)(T.L3,{children:"Add New User"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(B.J,{htmlFor:"username",children:["Username ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(F.p,{id:"username",value:u.username,onChange:e=>h({...u,username:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(B.J,{htmlFor:"email",children:["Email ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(F.p,{id:"email",type:"email",value:u.email,onChange:e=>h({...u,email:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(B.J,{htmlFor:"password",children:["Password ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(F.p,{id:"password",type:"password",value:u.password,onChange:e=>h({...u,password:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"role",children:"Role"}),(0,a.jsxs)(O.l6,{value:u.role,onValueChange:e=>h({...u,role:e}),children:[(0,a.jsx)(O.bq,{className:"bg-background border-input text-foreground",children:(0,a.jsx)(O.yv,{placeholder:"Select a role"})}),(0,a.jsx)(O.gC,{className:"bg-popover border border-border text-popover-foreground",children:c.map(e=>(0,a.jsx)(O.eb,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.d,{id:"is_active",checked:u.is_active,onCheckedChange:e=>h({...u,is_active:e})}),(0,a.jsx)(B.J,{htmlFor:"is_active",children:"Active"})]})]}),(0,a.jsxs)(T.Es,{children:[(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:x,disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Creating..."]}):"Add User"})]})]})})}function M(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid date";let a={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return s&&(a.second="2-digit"),t.toLocaleString("en-US",a)}catch(e){return console.error("Error formatting date:",e),"Error formatting date"}}function q(e){if(!e)return"N/A";try{let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"Invalid date";let t=new Date,a=Math.floor((t.getTime()-s.getTime())/1e3);if(a<60)return"".concat(a," second").concat(1!==a?"s":""," ago");let r=Math.floor(a/60);if(r<60)return"".concat(r," minute").concat(1!==r?"s":""," ago");let i=Math.floor(r/60);if(i<24)return"".concat(i," hour").concat(1!==i?"s":""," ago");let n=Math.floor(i/24);if(n<30)return"".concat(n," day").concat(1!==n?"s":""," ago");let o=Math.floor(n/30);if(o<12)return"".concat(o," month").concat(1!==o?"s":""," ago");let l=Math.floor(o/12);return"".concat(l," year").concat(1!==l?"s":""," ago")}catch(e){return console.error("Error calculating relative time:",e),"Error calculating time"}}function V(){let{users:e}=E(),[s,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(null),m=e=>{c(e),t(!0)},u=e=>{c(e),i(!0)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"User Management"}),(0,a.jsxs)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:()=>l(!0),children:[(0,a.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),(0,a.jsx)("div",{className:"bg-card p-4 rounded-lg border border-border overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border",children:[(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"ID"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Username"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Email"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Role"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Status"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Created"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,a.jsxs)("tr",{className:"border-b border-border hover:bg-accent/50",children:[(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.id}),(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.username}),(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.email}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("admin"===e.role?"bg-purple-500 text-white":"researcher"===e.role?"bg-blue-500 text-white":"bg-gray-500 text-white"),children:e.role})}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(e.is_active?"bg-green-500 text-white":"bg-red-500 text-white"),children:e.is_active?"Active":"Inactive"})}),(0,a.jsx)("td",{className:"p-3 text-muted-foreground",children:e.created_at?M(e.created_at,!1):"N/A"}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(U.Button,{variant:"outline",size:"sm",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20 text-xs h-7",onClick:()=>m(e),children:"Edit"}),"admin"!==e.username&&(0,a.jsx)(U.Button,{variant:"outline",size:"sm",className:"text-xs h-7 border-destructive text-destructive hover:bg-destructive/20",onClick:()=>u(e),children:"Delete"})]})})]},e.id))})]})}),s&&(0,a.jsx)(z,{open:s,onOpenChange:t,user:d}),r&&(0,a.jsx)(J,{open:r,onOpenChange:i,user:d}),(0,a.jsx)(X,{open:o,onOpenChange:l})]})}var G=t(4267),H=t(9993),Y=t(1466),W=t(6122);function Z(){let{activity:e,setActivity:s,users:t,isProcessing:r,setIsProcessing:i,setNotification:o}=E(),[l,d]=(0,n.useState)(!1),[c,m]=(0,n.useState)(new Date),[u,h]=(0,n.useState)(10),[x,p]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[b,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[w,_]=(0,n.useState)([]),[A,C]=(0,n.useState)([]),[S,I]=(0,n.useState)([]);(0,n.useEffect)(()=>{if(!l)return;let e=setInterval(()=>{P(!1),m(new Date)},1e3*u);return()=>clearInterval(e)},[l,u]),(0,n.useEffect)(()=>{e&&e.length>0&&(_([...new Set(e.map(e=>e.username))].filter(Boolean).sort()),C([...new Set(e.map(e=>e.action))].filter(Boolean).sort()),I([...new Set(e.map(e=>e.page_url).filter(Boolean))].sort()))},[e]),(0,n.useEffect)(()=>{if(e&&e.length>0){let t=e.map(e=>{if((!e.username||"system"===e.username)&&"Login"===e.action&&e.details){let s=e.details.match(/User (\w+) logged in/);if(s&&s[1])return console.log("Fixing username for login activity: ".concat(s[1])),{...e,username:s[1]}}return e});JSON.stringify(t)!==JSON.stringify(e)&&(console.log("Updating activity data with processed usernames"),s(t))}},[e,s]);let P=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&i(!0);try{let t=(await j()).activity.map(e=>({...e,formattedTime:M(e.timestamp),relativeTime:q(e.timestamp)}));s(t),e&&(o({type:"success",message:"Activity logs refreshed successfully"}),setTimeout(()=>o(null),3e3))}catch(s){console.error("Error refreshing activity logs:",s),e&&o({type:"error",message:"Failed to refresh activity logs"})}finally{e&&i(!1)}},L=async()=>{if(confirm("Are you sure you want to clear old activity logs? This cannot be undone.")){i(!0);try{await k(30),o({type:"success",message:"Activity logs older than 30 days have been cleared"});let e=await j();s(e.activity)}catch(e){console.error("Error clearing logs:",e),o({type:"error",message:"Failed to clear activity logs"})}finally{i(!1)}}},T=e.filter(e=>{let s=!x||"all"===x||e.username===x,t=!g||"all"===g||e.action===g,a=!b||"all"===b||e.page_url&&e.page_url.includes(b);return s&&t&&a}),F=(()=>{let s={};return console.log("Activity data for summary:",e),e.forEach(e=>{if(!e.username){console.log("Skipping item with no username:",e);return}let t=e.username;console.log("Processing activity for user: ".concat(t,", action: ").concat(e.action)),s[t]||(s[t]={totalActions:0,pageVisits:0,loginCount:0,lastActive:null}),s[t].totalActions++,"Page visit"===e.action?s[t].pageVisits++:"Login"===e.action&&s[t].loginCount++;let a=new Date(e.timestamp);(!s[t].lastActive||a>new Date(s[t].lastActive))&&(s[t].lastActive=e.timestamp)}),console.log("Generated activity summary:",s),s})(),B=e=>{if(!e)return"N/A";try{let s=new Date(e);if(isNaN(s.getTime()))return"Invalid Date";return s.toLocaleString()}catch(e){return"Invalid Date"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Activity Log"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center mr-4",children:[(0,a.jsx)("input",{type:"checkbox",id:"auto-refresh",checked:l,onChange:e=>d(e.target.checked),className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"auto-refresh",className:"text-sm text-muted-foreground",children:"Auto-refresh"})]}),l&&(0,a.jsxs)("div",{className:"flex items-center mr-4",children:[(0,a.jsx)("label",{htmlFor:"refresh-interval",className:"text-sm text-muted-foreground mr-2",children:"Every"}),(0,a.jsxs)("select",{id:"refresh-interval",value:u,onChange:e=>h(Number(e.target.value)),className:"bg-background border border-input rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"5",children:"5 sec"}),(0,a.jsx)("option",{value:"10",children:"10 sec"}),(0,a.jsx)("option",{value:"30",children:"30 sec"}),(0,a.jsx)("option",{value:"60",children:"1 min"})]})]}),(0,a.jsxs)(U.Button,{variant:"outline",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20",onClick:()=>N(!y),children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-2"}),y?"Hide Filters":"Show Filters"]}),(0,a.jsxs)(U.Button,{variant:"outline",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20",onClick:()=>P(),disabled:r,children:[(0,a.jsx)(R.A,{className:"h-4 w-4 mr-2 ".concat(r?"animate-spin":"")}),"Refresh"]}),(0,a.jsxs)(U.Button,{variant:"outline",className:"border-destructive text-destructive hover:bg-destructive/20",onClick:L,disabled:r,children:[(0,a.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"Clear Old Logs"]})]})]}),l&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:["Last refreshed: ",B(c)," (auto-refreshes every ",u," seconds)"]}),(0,a.jsxs)("div",{className:"bg-card/80 backdrop-blur-sm p-6 rounded-lg border border-border mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"User Activity Summary"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(F).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"bg-background/50 backdrop-blur-sm p-4 rounded-lg border border-border hover:shadow-md transition-shadow duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(Y.A,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"font-medium text-foreground",children:s})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Actions:"}),(0,a.jsx)("span",{className:"text-foreground",children:t.totalActions})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Page Visits:"}),(0,a.jsx)("span",{className:"text-foreground",children:t.pageVisits})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Last Active:"}),(0,a.jsx)("span",{className:"text-foreground",children:B(t.lastActive)})]})]})]},s)})})]}),y&&(0,a.jsx)("div",{className:"bg-card p-4 rounded-lg border border-border mb-4",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Filter by User"}),(0,a.jsxs)(O.l6,{value:x,onValueChange:p,children:[(0,a.jsx)(O.bq,{children:(0,a.jsx)(O.yv,{placeholder:"All Users"})}),(0,a.jsxs)(O.gC,{children:[(0,a.jsx)(O.eb,{value:"all",children:"All Users"}),w.map(e=>(0,a.jsx)(O.eb,{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Filter by Action"}),(0,a.jsxs)(O.l6,{value:g,onValueChange:f,children:[(0,a.jsx)(O.bq,{children:(0,a.jsx)(O.yv,{placeholder:"All Actions"})}),(0,a.jsxs)(O.gC,{children:[(0,a.jsx)(O.eb,{value:"all",children:"All Actions"}),A.map(e=>(0,a.jsx)(O.eb,{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Filter by Page"}),(0,a.jsxs)(O.l6,{value:b,onValueChange:v,children:[(0,a.jsx)(O.bq,{children:(0,a.jsx)(O.yv,{placeholder:"All Pages"})}),(0,a.jsxs)(O.gC,{children:[(0,a.jsx)(O.eb,{value:"all",children:"All Pages"}),S.map(e=>(0,a.jsx)(O.eb,{value:e,children:e},e))]})]})]}),(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>{p(""),f(""),v("")},className:"mb-0",children:"Reset Filters"})]})}),(0,a.jsx)("div",{className:"bg-card p-4 rounded-lg border border-border",children:0===T.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activity logs found"}):(0,a.jsx)("div",{className:"space-y-4",children:T.map((e,s)=>(0,a.jsxs)("div",{className:"p-3 border-b border-border last:border-0",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"text-card-foreground font-medium ".concat("Login"===e.action?"text-violet-500":""),children:e.action||"Unknown Action"}),(0,a.jsxs)("div",{className:"text-muted-foreground text-sm flex items-center gap-2",children:[(0,a.jsx)("span",{children:B(e.timestamp)}),(0,a.jsxs)("span",{className:"text-xs opacity-70",children:["(",q(e.timestamp),")"]})]})]}),(0,a.jsxs)("div",{className:"text-muted-foreground mt-1 flex items-center",children:[(0,a.jsx)(Y.A,{className:"h-4 w-4 mr-1 ".concat("Login"===e.action?"text-violet-500":"")}),(0,a.jsx)("span",{className:"font-medium",children:e.username||"Anonymous"})]}),e.details&&(0,a.jsx)("div",{className:"text-muted-foreground text-sm mt-1",children:e.details}),e.page_url&&(0,a.jsxs)("div",{className:"text-violet-500 text-sm mt-1 flex items-center",children:[(0,a.jsx)(W.A,{className:"h-3 w-3 mr-1"}),e.page_url]}),e.ip_address&&(0,a.jsxs)("div",{className:"text-muted-foreground text-xs mt-1",children:["IP: ",e.ip_address]})]},e.id||s))})}),T.length>0&&(0,a.jsxs)("div",{className:"text-center text-muted-foreground text-sm",children:["Showing ",T.length," of ",e.length," activities"]})]})}var K=t(6352),Q=t(8867),$=t(9602);let ee=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(K.bL,{ref:s,className:(0,$.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(K.C1,{className:(0,$.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(Q.A,{className:"h-4 w-4"})})})});ee.displayName=K.bL.displayName;var es=t(7358);async function et(){try{let e=es.env.NEXT_PUBLIC_API_URL?es.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t=await fetch("".concat(e,"/admin/roles"),{headers:{Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch roles: ".concat(t.statusText));let a=await t.json();console.log("Fetched roles from backend:",a);let{setRoles:r}=E.getState(),i=a.map(e=>{let s=Array.isArray(e.permissions_list)?e.permissions_list:Array.isArray(e.permissions)?e.permissions:[];return console.log("Role ".concat(e.name," permissions:"),s),{id:e.id,name:e.name,description:e.description||"",permissions:s,permissions_list:s,is_system_role:e.is_system_role||!1,created_at:e.created_at,updated_at:e.updated_at}});return r(i),await ea(),i}catch(t){console.error("Error syncing roles:",t);let{setRoles:e}=E.getState(),s=[{id:1,name:"admin",description:"Administrator with full access",permissions:["data:read","data:write","user:read","user:write","role:read","role:write"],is_system_role:!0},{id:2,name:"user",description:"Regular user with limited access",permissions:["data:read"],is_system_role:!0},{id:3,name:"researcher",description:"Researcher with data access",permissions:["data:read","data:write","schema:read","ingestion:read"],is_system_role:!0}];return e(s),s}}async function ea(){try{let e=es.env.NEXT_PUBLIC_API_URL?es.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",s=localStorage.getItem("token"),t=await fetch("".concat(e,"/admin/permissions"),{headers:{Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){console.warn("Failed to fetch permissions: ".concat(t.statusText,". Using default permissions."));let e=["data:read","data:write","data:delete","data:upload","ingestion:create","ingestion:read","ingestion:update","ingestion:delete","schema:read","schema:write","database:connect","database:read","database:write","user:read","user:create","user:update","user:delete","role:read","role:write","role:create","role:delete","kginsights:read","kginsights:write","kginsights:manage"],{setAvailablePermissions:s}=E.getState();return s(e),e}let a=await t.json();console.log("Fetched permissions from backend:",a);let{setAvailablePermissions:r}=E.getState();return r(a),a}catch(t){console.error("Error syncing permissions:",t);let e=["data:read","data:write","data:delete","data:upload","ingestion:create","ingestion:read","ingestion:update","ingestion:delete","schema:read","schema:write","database:connect","database:read","database:write","user:read","user:create","user:update","user:delete","role:read","role:write","role:create","role:delete","kginsights:read","kginsights:write","kginsights:manage"],{setAvailablePermissions:s}=E.getState();return s(e),e}}async function er(e){try{let s=es.env.NEXT_PUBLIC_API_URL?es.env.NEXT_PUBLIC_API_URL:"http://172.104.129.10:9090/api",t=localStorage.getItem("token"),a=!e.id,r=a?"".concat(s,"/admin/roles"):"".concat(s,"/admin/roles/").concat(e.id),i={...e,permissions:Array.isArray(e.permissions)?e.permissions:[]};console.log("Saving role to backend: ".concat(JSON.stringify(i)));let n=await fetch(r,{method:a?"POST":"PUT",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)});if(!n.ok){let e=await n.text();throw Error("Failed to save role: ".concat(n.statusText," - ").concat(e))}let o=await n.json();return console.log("Role saved successfully: ".concat(JSON.stringify(o))),o}catch(e){throw console.error("Error saving role:",e),e}}function ei(e){let{open:s,onOpenChange:t,role:r}=e,{roles:i,setRoles:o,availablePermissions:l,isProcessing:d,setIsProcessing:c,setNotification:m}=E(),[u,h]=(0,n.useState)({id:(null==r?void 0:r.id)||0,name:(null==r?void 0:r.name)||"",description:(null==r?void 0:r.description)||"",permissions:(null==r?void 0:r.permissions)||[],is_system_role:(null==r?void 0:r.is_system_role)||!1});(0,n.useEffect)(()=>{if(r){console.log("Role data received in EditRoleDialog:",r);let e=[];Array.isArray(r.permissions)&&r.permissions.length>0?e=r.permissions:Array.isArray(r.permissions_list)&&r.permissions_list.length>0&&(e=r.permissions_list),console.log("Permissions set in EditRoleDialog:",e),h({id:r.id||0,name:r.name||"",description:r.description||"",permissions:e,is_system_role:r.is_system_role||!1})}},[r]);let x=e=>{h(s=>{let t=s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e];return{...s,permissions:t}})},p=async()=>{if(!u.name){m({type:"error",message:"Role name is required"});return}if(u.is_system_role){m({type:"error",message:"System roles cannot be modified"});return}if(i.some(e=>e.id!==r.id&&e.name.toLowerCase()===u.name.toLowerCase())){m({type:"error",message:'Role "'.concat(u.name,'" already exists')});return}c(!0);try{let e=await er({id:r.id,name:u.name,description:u.description,permissions:u.permissions});console.log("Role saved successfully:",e);let s=i.map(s=>s.id===e.id?{...e,permissions:e.permissions_list||e.permissions||[]}:s);o(s),m({type:"success",message:'Role "'.concat(u.name,'" updated successfully')}),t(!1),setTimeout(()=>m(null),3e3)}catch(e){console.error("Error updating role:",e),m({type:"error",message:e.message||"Failed to update role"}),setTimeout(()=>m(null),3e3)}finally{c(!1)}};return(0,a.jsx)(T.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(T.Cf,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(T.c7,{children:(0,a.jsx)(T.L3,{children:"Edit Role"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(B.J,{htmlFor:"name",children:["Role Name ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(F.p,{id:"name",value:u.name,onChange:e=>h({...u,name:e.target.value}),placeholder:"Enter role name",disabled:u.is_system_role}),u.is_system_role&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"System roles cannot be modified"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(F.p,{id:"description",value:u.description,onChange:e=>h({...u,description:e.target.value}),placeholder:"Enter role description",disabled:u.is_system_role})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{children:"Permissions"}),(0,a.jsx)("div",{className:"space-y-2 border border-border rounded-md p-4 max-h-48 overflow-y-auto",children:l.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ee,{id:"permission-edit-".concat(e),checked:u.permissions.includes(e),onCheckedChange:()=>x(e),disabled:u.is_system_role}),(0,a.jsx)(B.J,{htmlFor:"permission-edit-".concat(e),className:"font-normal cursor-pointer",children:e})]},e))})]})]}),(0,a.jsxs)(T.Es,{children:[(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(U.Button,{onClick:p,disabled:d||u.is_system_role,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})}function en(e){let{open:s,onOpenChange:t}=e,{roles:r,setRoles:i,availablePermissions:o,isProcessing:l,setIsProcessing:d,setNotification:c}=E(),[m,u]=(0,n.useState)({name:"",description:"",permissions:[]});(0,n.useEffect)(()=>{s||u({name:"",description:"",permissions:[]})},[s]);let h=e=>{u(s=>{let t=s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e];return{...s,permissions:t}})},x=async()=>{if(!m.name){c({type:"error",message:"Role name is required"});return}if(r.some(e=>e.name.toLowerCase()===m.name.toLowerCase())){c({type:"error",message:'Role "'.concat(m.name,'" already exists')});return}d(!0);try{let e=await er({name:m.name,description:m.description,permissions:m.permissions});console.log("New role created successfully:",e);let s={...e,permissions:e.permissions_list||e.permissions||[]};i([...r,s]),c({type:"success",message:'Role "'.concat(m.name,'" created successfully')}),t(!1),u({name:"",description:"",permissions:[]}),setTimeout(()=>c(null),3e3)}catch(e){console.error("Error adding role:",e),c({type:"error",message:e.message||"Failed to create role"}),setTimeout(()=>c(null),3e3)}finally{d(!1)}};return(0,a.jsx)(T.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(T.Cf,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(T.c7,{children:(0,a.jsx)(T.L3,{children:"Add New Role"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(B.J,{htmlFor:"name",children:["Role Name ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(F.p,{id:"name",value:m.name,onChange:e=>u({...m,name:e.target.value}),className:"bg-background border-input text-foreground",placeholder:"e.g., editor",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(F.p,{id:"description",value:m.description,onChange:e=>u({...m,description:e.target.value}),className:"bg-background border-input text-foreground",placeholder:"Role description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(B.J,{children:"Permissions"}),(0,a.jsx)("div",{className:"space-y-2 border border-border rounded-md p-4 max-h-48 overflow-y-auto",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ee,{id:"permission-".concat(e),checked:m.permissions.includes(e),onCheckedChange:()=>h(e)}),(0,a.jsx)(B.J,{htmlFor:"permission-".concat(e),className:"font-normal cursor-pointer",children:e})]},e))})]})]}),(0,a.jsxs)(T.Es,{children:[(0,a.jsx)(U.Button,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:x,disabled:l,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Creating..."]}):"Add Role"})]})]})})}function eo(){let{roles:e,availablePermissions:s,setNotification:t}=E(),[r,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(null),[m,u]=(0,n.useState)(!0),h=e=>{let s={...e,permissions:Array.isArray(e.permissions)&&e.permissions.length>0?e.permissions:Array.isArray(e.permissions_list)&&e.permissions_list.length>0?e.permissions_list:[]};console.log("Opening edit dialog with formatted role:",s),c(s),i(!0)};return(0,n.useEffect)(()=>{(async()=>{u(!0);try{await et(),console.log("Roles synced successfully")}catch(e){console.error("Failed to sync roles:",e),t({type:"error",message:"Failed to load roles from the server"})}finally{u(!1)}})()},[t]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Role Management"}),(0,a.jsxs)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:()=>l(!0),children:[(0,a.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Add Role"]})]}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Configure role-based permissions and access controls for your application."}),(0,a.jsx)("div",{className:"bg-card p-6 rounded-lg border border-border",children:m?(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-violet-700"})}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:'No roles found. Click "Add Role" to create your first role.'}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsx)("div",{className:"p-4 border border-border rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-card-foreground font-medium mb-2",children:[e.name,e.is_system_role&&(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 rounded text-xs",children:"System"})]}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm mb-2",children:e.description}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.permissions&&e.permissions.map(e=>(0,a.jsx)("span",{className:"px-2 py-1 bg-accent rounded-md text-xs text-foreground",children:e},e))})]}),(0,a.jsx)(U.Button,{variant:"outline",size:"sm",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20 text-xs h-7",onClick:()=>h(e),disabled:e.is_system_role,title:e.is_system_role?"System roles cannot be modified":"Edit role",children:"Edit Role"})]})},e.id))})}),(0,a.jsx)(en,{open:o,onOpenChange:l}),d&&(0,a.jsx)(ei,{open:r,onOpenChange:i,role:d})]})}function el(){let{systemSettings:e,setSystemSettings:s,isProcessing:t,setIsProcessing:r,setNotification:i}=E(),n=async(e,t)=>{r(!0);try{let a=await w(e,t);s(a),i({type:"success",message:"".concat(e.replace(/_/g," ")," has been ").concat(t?"enabled":"disabled")}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error updating setting:",e),i({type:"error",message:"Failed to update setting"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},o=async()=>{r(!0);try{await _(),i({type:"success",message:"Backup process started"}),setTimeout(()=>{i(null)},3e3)}catch(e){console.error("Error starting backup:",e),i({type:"error",message:"Failed to start backup"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},l=async()=>{r(!0);try{await A(),i({type:"success",message:"Data export initiated"}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error exporting data:",e),i({type:"error",message:"Failed to export data"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},d=async()=>{r(!0);try{await C(),i({type:"success",message:"Data cleanup process started"}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error cleaning up data:",e),i({type:"error",message:"Failed to clean up data"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Settings"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-4",children:"System Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"Maintenance Mode"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Temporarily disable access to the application"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.d,{id:"maintenance-mode",checked:(null==e?void 0:e.maintenance_mode)||!1,onCheckedChange:e=>n("maintenance_mode",e),disabled:t}),(0,a.jsx)(B.J,{htmlFor:"maintenance-mode",className:"sr-only",children:"Maintenance Mode"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"Debug Mode"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Enable detailed error messages and logging"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.d,{id:"debug-mode",checked:(null==e?void 0:e.debug_mode)||!1,onCheckedChange:e=>n("debug_mode",e),disabled:t}),(0,a.jsx)(B.J,{htmlFor:"debug-mode",className:"sr-only",children:"Debug Mode"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"API Rate Limiting"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Limit API requests per user"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.d,{id:"api-rate-limiting",checked:(null==e?void 0:e.api_rate_limiting)||!1,onCheckedChange:e=>n("api_rate_limiting",e),disabled:t}),(0,a.jsx)(B.J,{htmlFor:"api-rate-limiting",className:"sr-only",children:"API Rate Limiting"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-4",children:"Data Management"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Database Backup"}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs mb-3",children:["Last backup:"," ",(null==e?void 0:e.last_backup)?new Date(e.last_backup).toLocaleString():"Never"]}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:o,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Running..."]}):"Run Backup Now"})]}),(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Data Export"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs mb-3",children:"Export system data for backup or migration"}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:l,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Exporting..."]}):"Export Data"})]}),(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Data Cleanup"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs mb-3",children:"Remove old or unused data from the system"}),(0,a.jsx)(U.Button,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:d,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Cleaning..."]}):"Cleanup Data"})]})]})]})]})]})}function ed(e){let{activeTab:s,loading:t,error:r}=e;return t?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(S.A,{})}):(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsx)("div",{className:"bg-yellow-500/20 border border-yellow-500 text-yellow-700 dark:text-yellow-200 px-4 py-2 rounded-md mb-4",children:(0,a.jsx)("p",{children:r})}),"dashboard"===s&&(0,a.jsx)(P,{}),"users"===s&&(0,a.jsx)(V,{}),"activity"===s&&(0,a.jsx)(Z,{}),"permissions"===s&&(0,a.jsx)(eo,{}),"settings"===s&&(0,a.jsx)(el,{})]})}var ec=t(3239),em=t(1594);function eu(e){let{notification:s}=e;return(0,a.jsxs)(d.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 rounded-md flex items-center backdrop-blur-sm border ".concat("success"===s.type?"bg-primary/10 border-primary text-primary":"bg-destructive/10 border-destructive text-destructive"),children:["success"===s.type?(0,a.jsx)(ec.A,{className:"h-5 w-5 mr-2"}):(0,a.jsx)(em.A,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("p",{children:s.message})]})}function eh(){let{user:e}=(0,g.A)();!function(){let{logout:e}=(0,g.A)();(0,f.useRouter)()}();let[s,t]=(0,n.useState)("dashboard"),{loading:i,setLoading:o,error:b,setError:v,notification:y,setNotification:N,stats:w,setStats:_,users:A,setUsers:k,activity:C,setActivity:I,systemSettings:P,setSystemSettings:L,addRoleIfNotExists:U}=E();(0,n.useEffect)(()=>{(async()=>{o(!0);try{let e=await j();e&&(_(e.stats||{}),k(e.users||[]),I(e.activity||[]),L(e.systemSettings||{}),e.users&&e.users.length>0&&e.users.forEach(e=>{e.role&&U(e.role)})),v(null)}catch(e){console.error("Error fetching admin data:",e),v("Failed to load admin data. Using mock data instead.")}finally{o(!1)}})()},[]);let R=[{id:"dashboard",label:"Dashboard",icon:c.A},{id:"users",label:"Users",icon:m.A},{id:"activity",label:"Activity Log",icon:u.A},{id:"permissions",label:"Permissions",icon:h.A},{id:"settings",label:"Settings",icon:x.A}],T={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,a.jsxs)("div",{className:"min-h-screen bg-background antialiased relative overflow-hidden",children:[(0,a.jsx)("div",{className:"h-full w-full absolute inset-0 z-0",children:(0,a.jsx)(r.n,{id:"tsparticlesfullpage",background:"transparent",minSize:.6,maxSize:1.4,particleDensity:100,className:"w-full h-full",particleColor:"var(--foreground)"})}),(0,a.jsxs)("div",{className:"relative z-10 pt-20 px-6 md:px-8",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto relative",children:(0,a.jsxs)(l(),{href:"/",className:"absolute -top-12 left-0 z-20 flex items-center justify-center rounded-md bg-card/80 backdrop-blur-sm border border-border hover:bg-accent transition-colors duration-200 px-3 py-2 text-sm","aria-label":"Back to home",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 text-foreground mr-2"}),(0,a.jsx)("span",{className:"text-foreground",children:"Back to Home"})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)(d.P.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary",children:"Admin Dashboard"}),(0,a.jsx)(d.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"flex items-center",children:(0,a.jsx)("div",{className:"px-4 py-2 bg-card/80 backdrop-blur-sm rounded-lg border border-border",children:(0,a.jsxs)("span",{className:"text-foreground font-medium",children:["Welcome, ",(0,a.jsx)("span",{className:"text-primary font-bold",children:null==e?void 0:e.username})]})})})]}),y&&(0,a.jsx)(eu,{notification:y}),(0,a.jsxs)(d.P.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"bg-card/80 backdrop-blur-sm rounded-lg border border-border overflow-hidden shadow-md",children:[(0,a.jsx)("div",{className:"flex border-b border-border overflow-x-auto",children:R.map((e,r)=>(0,a.jsxs)(d.P.button,{variants:T,className:"flex items-center space-x-2 px-6 py-4 text-sm font-medium transition-colors whitespace-nowrap ".concat(s===e.id?"text-primary-foreground bg-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-accent"),onClick:()=>t(e.id),children:[(0,a.jsx)(e.icon,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:e.label})]},e.id))}),(0,a.jsxs)("div",{className:"p-6",children:[i&&(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(S.A,{})}),!i&&(0,a.jsx)(ed,{activeTab:s,loading:i,error:b})]})]})]})]})]})}var ex=t(3726);function ep(){return(0,a.jsx)(ex.A,{requiredRole:"admin",children:(0,a.jsxs)("main",{className:"min-h-screen bg-background antialiased relative overflow-hidden",children:[(0,a.jsx)("div",{className:"h-full w-full absolute inset-0 z-0",children:(0,a.jsx)(r.n,{id:"tsparticlesfullpage",background:"transparent",minSize:.6,maxSize:1.4,particleDensity:100,className:"w-full h-full",particleColor:"var(--foreground)"})}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)(eh,{})]})]})})}},5472:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(5155),r=t(3638);function i(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)(r.P.div,{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full shadow-[0_0_15px_rgba(26,35,126,0.3)]",animate:{rotate:360},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"linear"}}),(0,a.jsx)("p",{className:"mt-4 text-foreground",children:"Loading data..."})]})}},3726:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var a=t(5155),r=t(1069),i=t(6046),n=t(2115),o=t(5472);function l(e){let{children:s,requiredRole:t,requiredPermission:l}=e,{user:d,isLoading:c}=(0,r.A)(),m=(0,i.useRouter)(),u=(0,i.usePathname)();return((0,n.useEffect)(()=>{let e="true"===sessionStorage.getItem("isLoggingOut");if(c||d){if(!c&&d){if("admin"===d.role)return;(t&&"admin"===t&&"admin"!==d.role||"researcher"===t&&!["admin","researcher"].includes(d.role))&&m.push("/"),l&&d.permissions&&!d.permissions.includes(l)&&m.push("/")}}else e?(sessionStorage.removeItem("isLoggingOut"),m.push("/")):m.push("/login?redirect=".concat(encodeURIComponent(u)))},[d,c,m,u,t,l]),c)?(0,a.jsx)("div",{className:"min-h-screen bg-black/[0.96] flex items-center justify-center",children:(0,a.jsx)(o.A,{})}):d?"admin"===d.role?(0,a.jsx)(a.Fragment,{children:s}):t&&("admin"===t&&"admin"!==d.role||"researcher"===t&&!["admin","researcher"].includes(d.role))||l&&d.permissions&&!d.permissions.includes(l)?null:(0,a.jsx)(a.Fragment,{children:s}):null}},7837:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>m,Es:()=>h,L3:()=>x,c7:()=>u,lG:()=>l});var a=t(5155),r=t(2115),i=t(6217),n=t(767),o=t(9602);let l=i.bL;i.l9;let d=i.ZL;i.bm;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.hJ,{ref:s,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});c.displayName=i.hJ.displayName;let m=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(c,{}),(0,a.jsxs)(i.UC,{ref:s,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l,children:[r,(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=i.UC.displayName;let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};u.displayName="DialogHeader";let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};h.displayName="DialogFooter";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.hE,{ref:s,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});x.displayName=i.hE.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.VY,{ref:s,className:(0,o.cn)("text-sm text-muted-foreground",t),...r})}).displayName=i.VY.displayName},2336:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(5155),r=t(2115),i=t(9602);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},5785:(e,s,t)=>{"use strict";t.d(s,{J:()=>d});var a=t(5155),r=t(2115),i=t(6195),n=t(6421),o=t(9602);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.b,{ref:s,className:(0,o.cn)(l(),t),...r})});d.displayName=i.b.displayName},745:(e,s,t)=>{"use strict";t.d(s,{bq:()=>u,eb:()=>g,gC:()=>p,l6:()=>c,yv:()=>m});var a=t(5155),r=t(2115),i=t(1848),n=t(1719),o=t(1902),l=t(8867),d=t(9602);let c=i.bL;i.YJ;let m=i.WT,u=r.forwardRef((e,s)=>{let{className:t,children:r,...o}=e;return(0,a.jsxs)(i.l9,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...o,children:[r,(0,a.jsx)(i.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=i.l9.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.PP,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})});h.displayName=i.PP.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.wn,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=i.wn.displayName;let p=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...o}=e;return(0,a.jsx)(i.ZL,{children:(0,a.jsxs)(i.UC,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...o,children:[(0,a.jsx)(h,{}),(0,a.jsx)(i.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(x,{})]})})});p.displayName=i.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.JU,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=i.JU.displayName;let g=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(i.q7,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(i.VF,{children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})}),(0,a.jsx)(i.p4,{children:r})]})});g.displayName=i.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.wv,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=i.wv.displayName},2581:(e,s,t)=>{"use strict";t.d(s,{d:()=>o});var a=t(5155),r=t(2115),i=t(2413),n=t(9602);let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.bL,{className:(0,n.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(i.zi,{className:(0,n.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=i.bL.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[487,565,984,811,99,167,786,441,517,358],()=>s(7394)),_N_E=e.O()}]);