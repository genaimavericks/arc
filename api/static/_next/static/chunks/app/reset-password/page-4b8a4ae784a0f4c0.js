(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{4932:(e,s,t)=>{Promise.resolve().then(t.bind(t,1718))},1718:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(5155),a=t(2115),l=t(425),i=t(3638),n=t(7410),o=t(1569),d=t(3239),c=t(7364),m=t(8686),h=t(8173),u=t.n(h),x=t(4085),p=t(2336),w=t(1069),f=t(6046),b=t(7358);function g(){let[e,s]=(0,a.useState)(""),[t,h]=(0,a.useState)(""),[g,j]=(0,a.useState)(null),[N,v]=(0,a.useState)(!1),[y,k]=(0,a.useState)(!1),[P,S]=(0,a.useState)(null),{useFallbackMode:A}=(0,w.A)(),E=(0,f.useSearchParams)(),F=(0,f.useRouter)();(0,a.useEffect)(()=>{let e=E.get("token");e?j(e):S("Missing reset token. Please request a new password reset link.")},[E]);let C=async s=>{if(s.preventDefault(),e!==t){S("Passwords do not match");return}if(!g){S("Missing reset token");return}v(!0),S(null);try{if(A){await new Promise(e=>setTimeout(e,1e3)),k(!0);return}let s=b.env.NEXT_PUBLIC_API_URL||"http://172.104.129.10:9090/api",t=await fetch("".concat(s,"/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:g,password:e})}),r=t.headers.get("content-type");if(!r||!r.includes("application/json")){let e=await t.text();throw console.error("Received non-JSON response:",e.substring(0,200)+"..."),Error("Server returned non-JSON response. API might be unavailable.")}if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to reset password")}k(!0)}catch(e){console.error("Password reset error:",e),S(e instanceof Error?e.message:"Failed to reset password"),e instanceof TypeError&&"Failed to fetch"===e.message&&S("Cannot connect to the server. The system is in demo mode.")}finally{v(!1)}};return(0,a.useEffect)(()=>{if(y){let e=setTimeout(()=>{F.push("/login")},3e3);return()=>clearTimeout(e)}},[y,F]),(0,r.jsxs)("main",{className:"min-h-screen bg-black/[0.96] antialiased bg-grid-white/[0.02] relative overflow-hidden",children:[(0,r.jsx)("div",{className:"h-full w-full absolute inset-0 z-0",children:(0,r.jsx)(l.n,{id:"tsparticlesfullpage",background:"transparent",minSize:.6,maxSize:1.4,particleDensity:100,className:"w-full h-full",particleColor:"#FFFFFF"})}),(0,r.jsx)("div",{className:"relative z-10 flex items-center justify-center min-h-screen",children:(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md p-8 bg-white/5 backdrop-blur-sm rounded-lg border border-white/10",children:[(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsx)(n.A,{className:"w-12 h-12 text-purple-500"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white text-center mb-6",children:"Set New Password"}),P&&(0,r.jsx)("div",{className:"bg-red-500/20 border border-red-500 text-red-200 px-4 py-2 rounded-md mb-4",children:P}),A&&!y&&(0,r.jsxs)("div",{className:"bg-yellow-500/20 border border-yellow-500 text-yellow-200 px-4 py-2 rounded-md mb-4 flex items-start",children:[(0,r.jsx)(o.A,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Using Demo Mode"}),(0,r.jsx)("p",{className:"text-sm",children:"API server is unavailable. Password reset will be simulated."})]})]}),y?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)(d.A,{className:"w-16 h-16 text-green-500"})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Password Reset Successful"}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"Your password has been reset successfully. You will be redirected to the login page."}),(0,r.jsxs)(u(),{href:"/login",className:"text-purple-600 dark:text-purple-400 hover:text-purple-500 dark:hover:text-purple-300 flex items-center justify-center",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"Enter your new password below."}),(0,r.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,r.jsx)(p.p,{id:"password",type:"password",value:e,onChange:e=>s(e.target.value),className:"pl-10 bg-white/5 border-white/10 text-white",placeholder:"Enter new password",required:!0,minLength:6})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm New Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,r.jsx)(p.p,{id:"confirmPassword",type:"password",value:t,onChange:e=>h(e.target.value),className:"pl-10 bg-white/5 border-white/10 text-white",placeholder:"Confirm new password",required:!0,minLength:6})]})]}),(0,r.jsx)(x.Button,{type:"submit",className:"w-full bg-violet-600 hover:bg-violet-700 text-white btn-glow",disabled:N||!g,children:N?"Resetting...":"Reset Password"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)(u(),{href:"/login",className:"text-purple-600 dark:text-purple-400 hover:text-purple-500 dark:hover:text-purple-300 flex items-center justify-center",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Back to Login"]})})]})]})})]})}},8686:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(7401).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[487,602,441,517,358],()=>s(4932)),_N_E=e.O()}]);